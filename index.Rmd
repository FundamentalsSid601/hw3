---
title: "Data Cleaning and Formatting"
author: "Sidhant Sharma"
output:
  html_document:
    df_print: paged
---


```{r}
data_1 <- read.csv("Infant mortality rate.csv")
data_2 <- read.csv("Life expectancy at birth.csv")
data_3 <- read.csv("Maternal mortality ratio.csv")
```

#### Investigating Column Names

```{r}
names(data_1)
names(data_2)
names(data_3)
```


### Fixing Column Names

```{r}
raw_lines_infant <- readLines("Infant mortality rate.csv")
raw_lines_infant[1] <- "name,slug,deaths_per_1000,date_of_information,ranking,region"
infant <- read.csv(text = raw_lines_infant)
```


```{r}
raw_lines <- readLines("Maternal mortality ratio.csv")
raw_lines[1] <- "name,slug,deaths_per_100000,date_of_information,ranking,region"
maternal <- read.csv(text = raw_lines)
```


```{r}
life_exp <- data_2
```

### Initial Inspection

```{r}
head(infant); tail(infant); str(infant); summary(infant)
head(life_exp); tail(life_exp); str(life_exp); summary(life_exp)
head(maternal); tail(maternal); str(maternal); summary(maternal)
```


### Keep only required columns
```{r}
infant_new <- infant[, c("name", "deaths_per_1000", "region")]
life_exp_new <- life_exp[, c("name", "years", "region")]
maternal_new <- maternal[, c("name", "deaths_per_100000", "region")]

head(infant_new)
head(life_exp_new)
head(maternal_new)
```

### Trim Whitespaces 

```{r}
infant_new$name <- trimws(infant_new$name)
infant_new$region <- trimws(infant_new$region)

life_exp_new$name <- trimws(life_exp_new$name)
life_exp_new$region <- trimws(life_exp_new$region)

maternal_new$name <- trimws(maternal_new$name)
maternal_new$region <- trimws(maternal_new$region)
```


#### Checking for NA Values

```{r}
# NA counts per column
colSums(is.na(infant_new))
colSums(is.na(life_exp_new))
colSums(is.na(maternal_new))
```


### Ensure numeric columns are numeric

```{r}
infant_new$deaths.1000.live.births <- as.numeric(infant_new$deaths_per_1000)
life_exp_new$years <- as.numeric(life_exp_new$years)
maternal_new$deaths_per_100000 <- as.numeric(maternal_new$deaths_per_100000)
```

### Rename columns to more appopriate names

```{r}
names(infant_new) <- c("country", "infant_mortality_per_1000", "region")
names(life_exp_new) <- c("country", "life_expectancy_years", "region")
names(maternal_new) <- c("country", "maternal_mortality_per_100k", "region")
```


### Save cleaned datasets (RDS + CSV)

```{r}
saveRDS(infant_new, "infant_mortality_clean.rds")
saveRDS(life_exp_new, "life_expectancy_clean.rds")
saveRDS(maternal_new, "maternal_mortality_clean.rds")

write.csv(infant_new, "infant_mortality_clean.csv", row.names = FALSE, na = "")
write.csv(life_exp_new, "life_expectancy_clean.csv", row.names = FALSE, na = "")
write.csv(maternal_new, "maternal_mortality_clean.csv", row.names = FALSE, na = "")
```


### Re-open each file and verify types using str()

#### RDS

```{r}
imr_rds <- readRDS("infant_mortality_clean.rds")
le_rds <- readRDS("life_expectancy_clean.rds")
mmr_rds <- readRDS("maternal_mortality_clean.rds")

str(imr_rds)
str(le_rds)
str(mmr_rds)
```

#### CVS

```{r}
imr_csv <- read.csv("infant_mortality_clean.csv", stringsAsFactors = FALSE)
le_csv <- read.csv("life_expectancy_clean.csv", stringsAsFactors = FALSE)
mmr_csv <- read.csv("maternal_mortality_clean.csv", stringsAsFactors = FALSE)

str(imr_csv)
str(le_csv)
str(mmr_csv)
```

